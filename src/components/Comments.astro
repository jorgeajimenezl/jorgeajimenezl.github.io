---
import FormattedDate from "@components/FormattedDate.astro";

interface Props {
  postSlug: string;
}

// const { postSlug } = Astro.props as Props;

// TODO: Replace mocked comments with a real fetch to your API.
// Example:
// const comments = await fetch(`/api/comments?slug=${postSlug}`).then(r => r.json());
// For now, we mock 2 comments so layout and styles are set.
const comments = [
  {
    id: "c1",
    author: "Alex",
    date: new Date("2024-08-15T10:30:00Z"),
    content:
      "Really enjoyed this post! The section on performance tips was super helpful.",
  },
  {
    id: "c2",
    author: "Samira",
    date: new Date("2024-09-02T18:45:00Z"),
    content:
      "Thanks for sharing. I'd love a follow-up with code samples for the build step.",
  },
];
---

<!-- <div class="separator my-12 border-t border-black/10 dark:border-white/10"></div> -->

<div class="my-12 border-t border-black/10 dark:border-white/10"></div>
<section aria-labelledby="comments-title" class="mt-8">
  <h2 id="comments-title" class="text-xl font-semibold text-black dark:text-white mb-4">
    Comments
  </h2>

  {comments.length === 0 ? (
    <p class="text-sm text-black/60 dark:text-white/60">
      No comments yet.
    </p>
  ) : (
    <ul class="space-y-6">
      {comments.map((c) => (
        <li class="rounded-lg border border-black/10 dark:border-white/10 p-4">
          <div class="flex items-center gap-2 mb-2">
            <span class="font-medium text-black dark:text-white">{c.author}</span>
            <span class="text-black/40 dark:text-white/40">•</span>
            <span class="text-sm text-black/60 dark:text-white/60">
              <FormattedDate date={c.date} />
            </span>
          </div>
          <p class="prose prose-sm dark:prose-invert m-0">
            {c.content}
          </p>
        </li>
      ))}
    </ul>
  )}

  <h3 class="mt-8 text-base font-semibold text-black dark:text-white">Leave a comment</h3>
  <form class="mt-3 space-y-3" onsubmit="event.preventDefault()">
    <label for="comment" class="sr-only">Your comment</label>
    <textarea
      id="comment"
      name="comment"
      rows="4"
      placeholder="Write your comment…"
      class="w-full resize-y rounded-md border border-black/10 dark:border-white/10 bg-white/70 dark:bg-stone-900/50 p-3 text-sm text-black dark:text-white shadow-sm focus:outline-none focus:ring-2 focus:ring-black/20 dark:focus:ring-white/30"
    ></textarea>
    <div class="flex items-center gap-3">
      <button
        type="submit"
        disabled
        class="inline-flex items-center rounded-md bg-black/80 px-3 py-1.5 text-sm font-medium text-white opacity-60 dark:bg-white/20 cursor-not-allowed"
      >
        Post comment
      </button>
      <span class="text-xs text-black/50 dark:text-white/50">Don't share personal information.</span>
    </div>
  </form>
</section>
